{"version":3,"file":"has.js","sourceRoot":"","sources":["has.ts"],"names":["add","has"],"mappings":"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","sourcesContent":["import global from './global';\nimport { Hash } from './interfaces';\nexport const cache: Hash<any> = Object.create(null);\nconst testFunctions: Hash<() => any> = Object.create(null);\n\n/**\n * Register a new test for a named feature.\n *\n * @example\n * has.add('dom-addeventlistener', !!document.addEventListener);\n *\n * @example\n * has.add('touch-events', function () {\n *    return 'ontouchstart' in document\n * });\n */\nexport function add(feature: string, value: any, overwrite: boolean = false): void {\n\tif ((feature in cache || feature in testFunctions) && !overwrite) {\n\t\treturn;\n\t}\n\n\tif (typeof value === 'function') {\n\t\ttestFunctions[feature] = value;\n\t}\n\telse {\n\t\tcache[feature] = value;\n\t}\n}\n\n/**\n * Return the current value of a named feature.\n *\n * @param feature The name (if a string) or identifier (if an integer) of the feature to test.\n * @return The value of a given feature test\n */\nexport default function has(feature: string): any {\n\tlet result: any;\n\n\tif (testFunctions[feature]) {\n\t\tresult = cache[feature] = testFunctions[feature].call(null);\n\t\ttestFunctions[feature] = null;\n\t}\n\telse {\n\t\tresult = cache[feature];\n\t}\n\n\treturn result;\n}\n\n/*\n * OOTB feature tests\n */\nadd('host-browser', typeof document !== 'undefined' && typeof location !== 'undefined');\nadd('host-node', function () {\n\tif (typeof process === 'object' && process.versions && process.versions.node) {\n\t\treturn process.versions.node;\n\t}\n});\nadd('float32array', 'Float32Array' in global);\nadd('setimmediate', typeof global.setImmediate !== 'undefined');\nadd('dom-mutationobserver', function(): boolean {\n\treturn has('host-browser') && Boolean(global.MutationObserver || global.WebKitMutationObserver);\n});\nadd('microtasks', function () {\n\treturn has('promise') || has('host-node') || has('dom-mutationobserver');\n});\nadd('object-assign', typeof (<any> Object).assign === 'function');\nadd('object-observe', typeof (<any> Object).observe === 'function');\nadd('postmessage', typeof postMessage === 'function');\nadd('promise', typeof global.Promise !== 'undefined');\nadd('raf', typeof requestAnimationFrame === 'function');\nadd('weakmap', function () {\n\tif (typeof global.WeakMap !== 'undefined') {\n\t\tconst key1 = {};\n\t\tconst key2 = {};\n\t\tconst map = new global.WeakMap([ [ key1, 1 ] ]);\n\t\treturn map.get(key1) === 1 && map.set(key2, 2) === map;\n\t}\n\treturn false;\n});\nadd('formdata', typeof global.FormData !== 'undefined');\nadd('xhr', typeof global.XMLHttpRequest !== 'undefined');\nadd('xhr2', has('xhr') && 'responseType' in global.XMLHttpRequest.prototype);\nadd('xhr2-blob', function () {\n\tif (!has('xhr2')) {\n\t\treturn false;\n\t}\n\n\tconst request = new XMLHttpRequest();\n\trequest.open('GET', '/', true);\n\trequest.responseType = 'blob';\n\trequest.abort();\n\treturn request.responseType === 'blob';\n});\n"]}